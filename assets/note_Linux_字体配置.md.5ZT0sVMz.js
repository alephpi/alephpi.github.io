import{_ as n,c as a,ap as l,o}from"./chunks/framework.CCxIPCIe.js";const g=JSON.parse('{"title":"字体配置","description":"","frontmatter":{"title":"字体配置","date":"2023-04-08T22:00:00.000Z","length":"651字","time":"3分钟","aside":true,"hash":-463440785},"headers":[],"relativePath":"note/Linux/字体配置.md","filePath":"note/Linux/字体配置.md"}'),p={name:"note/Linux/字体配置.md"};function t(e,s,r,c,y,i){return o(),a("div",null,s[0]||(s[0]=[l(`<p>系统：deepin v20.8</p><p>使用 rime 中州韵的过程中，我发现有些字符无法显示，如“𠱞”。之前使用小狼毫的时候，没有这个问题。一问，原来是 win 除了微软雅黑之外，还使用了一个新细明体作为 fallback 字体，能够接住这个生僻字。而 deepin 上并不自带字库更大的 fallback 字体，需要手动配置。</p><p>到网上转了一圈才大概梳理出一点头绪，这里整理一下：</p><ol><li><p>首先在网上下载需要的字体，这里我们使用<a href="https://github.com/max32002/max-hana/tree/master/ttf" target="_blank" rel="noreferrer">花园明朝（HanaMin）</a>，这是一款免费字体，几乎囊括全汉字字库。（我在这只使用了 HanaMinA.ttf 与 HanaMinB.ttf）</p></li><li><p>双击字体文件，用 deepin 自带的字体安装器安装。<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>（命令行安装可以参考 archlinux wiki<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>）</p></li><li><p>来到<code>~/.config/fontconfig/conf.d/</code>路径，这里存放着用户的字体配置文件。我的路径下只有<code>99-deepin.conf</code>这一项，于是我直接在里面修改了。该文件是 xml 格式文件，内容如下：</p></li></ol><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki solarized-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#586E75;">&lt;?</span><span style="color:#268BD2;">xml</span><span style="color:#93A1A1;"> version</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;1.0&quot;</span><span style="color:#586E75;">?&gt;</span></span>
<span class="line"><span style="color:#586E75;">&lt;!</span><span style="color:#859900;">DOCTYPE</span><span style="color:#268BD2;"> fontconfig</span><span style="color:#839496;"> SYSTEM &quot;fonts.dtd&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">&lt;</span><span style="color:#268BD2;">fontconfig</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">    &lt;</span><span style="color:#268BD2;">match</span><span style="color:#93A1A1;"> target</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;pattern&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;</span><span style="color:#268BD2;">test</span><span style="color:#93A1A1;"> qual</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;any&quot;</span><span style="color:#93A1A1;"> name</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;family&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">serif</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;/</span><span style="color:#268BD2;">test</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;</span><span style="color:#268BD2;">edit</span><span style="color:#93A1A1;"> name</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;family&quot;</span><span style="color:#93A1A1;"> mode</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;assign&quot;</span><span style="color:#93A1A1;"> binding</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;strong&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">Noto Sans CJK SC</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">Noto Sans</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">HanaMinA</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">HanaMinB</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;/</span><span style="color:#268BD2;">edit</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">    &lt;/</span><span style="color:#268BD2;">match</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586E75;">    &lt;</span><span style="color:#268BD2;">match</span><span style="color:#93A1A1;"> target</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;pattern&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;</span><span style="color:#268BD2;">test</span><span style="color:#93A1A1;"> qual</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;any&quot;</span><span style="color:#93A1A1;"> name</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;family&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">sans-serif</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;/</span><span style="color:#268BD2;">test</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;</span><span style="color:#268BD2;">edit</span><span style="color:#93A1A1;"> name</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;family&quot;</span><span style="color:#93A1A1;"> mode</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;assign&quot;</span><span style="color:#93A1A1;"> binding</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;strong&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">Noto Sans CJK SC</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">Noto Sans</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">HanaMinA</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">HanaMinB</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;/</span><span style="color:#268BD2;">edit</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">    &lt;/</span><span style="color:#268BD2;">match</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586E75;">    &lt;</span><span style="color:#268BD2;">match</span><span style="color:#93A1A1;"> target</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;pattern&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;</span><span style="color:#268BD2;">test</span><span style="color:#93A1A1;"> qual</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;any&quot;</span><span style="color:#93A1A1;"> name</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;family&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">monospace</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;/</span><span style="color:#268BD2;">test</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;</span><span style="color:#268BD2;">edit</span><span style="color:#93A1A1;"> name</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;family&quot;</span><span style="color:#93A1A1;"> mode</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;assign&quot;</span><span style="color:#93A1A1;"> binding</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;strong&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">Noto Mono</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">            &lt;</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">Noto Mono</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">string</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;/</span><span style="color:#268BD2;">edit</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">    &lt;/</span><span style="color:#268BD2;">match</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586E75;">    &lt;</span><span style="color:#268BD2;">match</span><span style="color:#93A1A1;"> target</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;font&quot;</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">        &lt;</span><span style="color:#268BD2;">edit</span><span style="color:#93A1A1;"> name</span><span style="color:#839496;">=</span><span style="color:#2AA198;">&quot;rgba&quot;</span><span style="color:#586E75;">&gt;&lt;</span><span style="color:#268BD2;">const</span><span style="color:#586E75;">&gt;</span><span style="color:#839496;">rgb</span><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">const</span><span style="color:#586E75;">&gt;&lt;/</span><span style="color:#268BD2;">edit</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">    &lt;/</span><span style="color:#268BD2;">match</span><span style="color:#586E75;">&gt;</span></span>
<span class="line"><span style="color:#586E75;">&lt;/</span><span style="color:#268BD2;">fontconfig</span><span style="color:#586E75;">&gt;</span></span></code></pre></div><p>第一眼我也不懂，好在有 chatgpt。大概就是每一个<code>match</code>块对应着一种 font-family 的渲染模式，譬如第一块是衬线字体的渲染方式，<code>edit</code>内部定义了衬线字体的渲染优先级，即先用 Noto Sans CJK SC 渲染衬线字体，否则到 Noto Sans 中寻找，以此类推。我在后面添加上了 HanaMinA 与 HanaMinB 接住前面二者的漏网之字。后面的无衬线和等宽字体同上配置。<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p><ol start="4"><li>保存并重启，“𠱞”字就能顺利渲染了。</li></ol><p>参考资料：</p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://m.uc23.net/jiaocheng/71479.html" target="_blank" rel="noreferrer">https://m.uc23.net/jiaocheng/71479.html</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p></li><li id="fn2" class="footnote-item"><p><a href="https://wiki.archlinuxcn.org/wiki/%E5%AD%97%E4%BD%93#%E6%89%8B%E5%8A%A8%E5%AE%89%E8%A3%85" target="_blank" rel="noreferrer">archlinux wiki 字体安装</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p></li><li id="fn3" class="footnote-item"><p>linux 的字体渲染由 fontconfig 这个库管理，一般配有 GUI 界面的 linux 发行版自带该库。详见<a href="https://wiki.archlinuxcn.org/wiki/%E5%AD%97%E4%BD%93%E9%85%8D%E7%BD%AE#%E9%A2%84%E8%AE%BE" target="_blank" rel="noreferrer">archlinux wiki 字体配置</a> <a href="#fnref3" class="footnote-backref">↩︎</a></p></li></ol></section>`,10)]))}const A=n(p,[["render",t]]);export{g as __pageData,A as default};
